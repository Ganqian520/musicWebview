import{i,s as c}from"./index.adfedd9b.js";import{j as m}from"./vendor.d4761c69.js";function g(e){if(typeof e=="number"){let a=parseInt(e/60),o=parseInt(e-a*60);return a=a<10?`0${a}`:a,o=o<10?`0${o}`:o,`${a}:${o}`}else return parseInt(e.slice(0,2))*60+parseInt(e.slice(3,5))}function u(e){return e.map(a=>({name:a.name,id:a.id,author:a.ar.map(o=>o.name).join("/"),time:Math.floor(a.dt/1e3),platform:"net"}))}function h(e){return new Promise((a,o)=>{i.get("/comment/music",{params:{id:e}}).then(t=>{let n=t.data.hotComments.reduce((r,s)=>r+"\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0"+s.user.nickname+"\uFF1A"+s.content,"");a(n.replace(`
`,""))}).catch(t=>console.log(t))})}function f(){return new Promise((e,a)=>{i.get("/personal_fm").then(o=>{let t=o.data.data.map(n=>({name:n.name,id:n.id,author:n.artists.map(r=>r.name).join("/"),time:Math.floor(n.duration/1e3),platform:"net"}));e(t)}).catch(o=>console.log(o))})}function S(e){return new Promise((a,o)=>{i.get("/like",{params:{id:e}}).then(t=>console.log(t.data)).catch(t=>console.log(t))})}function y(e){return c.msg.value=1,new Promise((a,o)=>{fetch(e,{responseType:"blob"}).then(t=>t.blob()).then(async t=>{c.msg.value=0;let n=URL.createObjectURL(t);a(n)}).catch(t=>{c.msg.value=0,console.log(t)})})}function N(e){return new Promise((a,o)=>{i.get("/cloudsearch",{params:{keywords:e}}).then(t=>{a(u(t.data.result.songs))}).catch(t=>console.log(t))})}function j(){return new Promise((e,a)=>{let o=JSON.parse(localStorage.getItem("user")).uid;i.get("/recommend/songs",{params:{uid:o}}).then(t=>{e(u(t.data.data.dailySongs))}).catch(t=>console.log(t))})}function x(e){return new Promise((a,o)=>{i.get("/lyric",{params:{id:e}}).then(t=>{if(t=t.data,t.nolyric)a([]);else{let n=t.lrc.lyric.split(`
`),r=[];for(let s of n){if(s=="")continue;let l={};l.content=s.match(/](.*)/)[1],l.content!=""&&(l.time=s.slice(1,6),l.second=g(l.time),r.push(l))}a(r)}}).catch(t=>console.log(t))})}function L(e){return new Promise((a,o)=>{let t=`https://music.163.com/song/media/outer/url?id=${e}.mp3`;m({method:"POST",url:"https://ca448d14-fda5-4d8f-9279-3f4896d8f854.bspapp.com/index",data:JSON.stringify({action:"getNetEaseMusicUrl",url:t})}).then(r=>{if(r.data.url!="https://music.163.com/404"){let s=r.data.url.replace(/(http|https)/,"https");a(s)}else i.get(`/song/url?id=${e}`).then(s=>{let l=s.data.data[0].url.replace(/(http|https)/,"https");a(l)}).catch(s=>console.log(s))}).catch(r=>console.log(r))})}function O(){return new Promise((e,a)=>{let o=localStorage.getItem("douList");o?e(JSON.parse(o)):(c.msg.value=1,m({method:"POST",url:"https://ca448d14-fda5-4d8f-9279-3f4896d8f854.bspapp.com/index",data:JSON.stringify({action:"getDouYin"})}).then(n=>{c.msg.value=0;let r=n.data.data.map(s=>({name:s.name,tag:s.tag,author:s.res.musicAuthor,time:s.res.musicDuration,url:s.res.musicUrl,platform:"dou"}));localStorage.setItem("douList",JSON.stringify(r)),e(r)}).catch(n=>{c.msg.value=0,console.log(n)}))})}async function I(e){return new Promise((a,o)=>{i.get("/captcha/sent",{params:{phone:e}}).then(t=>{a(!0)}).catch(t=>console.log(t))})}async function P(e,a){return new Promise((o,t)=>{i.get("/login/cellphone",{params:{phone:e,captcha:a}}).then(n=>{n=n.data;let r={uid:n.account.id,avatarUrl:n.profile.avatarUrl,nickName:n.profile.nickname};localStorage.setItem("user",JSON.stringify(r)),c.isLogin.value=!0,o()}).catch(n=>console.log(n))})}function w(e){return new Promise((a,o)=>{let t=JSON.parse(localStorage.getItem("user")).uid,n=localStorage.getItem(`songsListNet${t}`),r=localStorage.getItem(`songListNet${e}`);r?a(JSON.parse(r)):i.get("/playlist/detail",{params:{id:e}}).then(s=>{console.log(s.data);let l=u(s.data.playlist.tracks);e==JSON.parse(n)[0].id&&localStorage.setItem(`songListNet${e}`,JSON.stringify(l)),a(l)}).catch(s=>console.log(s))})}function J(){return new Promise((e,a)=>{let o=JSON.parse(localStorage.getItem("user")).uid,t=localStorage.getItem(`songsListNet${o}`);t?e(JSON.parse(t)):i.get("/user/playlist",{params:{uid:o}}).then(n=>{n=n.data;let r=[{id:n.playlist[0].id,name:"\u6211\u559C\u6B22"}];for(let s=1;s<n.playlist.length;s++)n.playlist[s].subscribed||r.push({id:n.playlist[s].id,name:n.playlist[s].name});localStorage.setItem(`songsListNet${o}`,JSON.stringify(r)),e(r)}).catch(n=>console.log(n))})}export{y as a,x as b,J as c,w as d,f as e,j as f,L as g,S as h,O as i,I as j,h as k,P as l,N as s,g as t};
